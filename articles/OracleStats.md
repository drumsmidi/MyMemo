# 統計情報

```SQL
--統計情報の収集
BEGIN
DBMS_STATS.GATHER_DATABASE_STATS;
END;
/

BEGIN
--テーブル単位の収集
DBMS_STATS.GATHER_TABLE_STATS
(
	OWNNAME      => 'TEST'
,	TABNAME      => 'TBLNAME'
,	METHOD_OPT   => 'FOR ALL INDEXED'
,	CASCADE      => TRUE
);
END;
/

BEGIN
--スキーマ単位の収集
DBMS_STATS.GATHER_SCHEMA_STATS
(
    OWNNAME => 'TEST'
,   OPTIONS => 'GATHER'
);
END;
/

-- 統計情報最終取得日取得
SELECT TABLE_NAME, LAST_ANALYZED FROM USER_TABLES  WHERE TABLE_NAME = 'テーブル名'
UNION ALL
SELECT INDEX_NAME, LAST_ANALYZED FROM USER_INDEXES WHERE INDEX_NAME = 'インデックス名'
/

-- 統計情報未取得のテーブル、インデックス
SELECT TABLE_NAME, LAST_ANALYZED FROM DBA_TABLES  WHERE OWNER in ( 'TEST' ) AND LAST_ANALYZED IS NULL
UNION ALL
SELECT INDEX_NAME, LAST_ANALYZED FROM DBA_INDEXES WHERE OWNER in ( 'TEST' ) AND LAST_ANALYZED IS NULL
/

-- 統計ロック情報
SELECT * FROM DBA_TAB_STATISTICS WHERE STATTYPE_LOCKED IS NOT NULL ORDER BY OWNER, TABLE_NAME;

-- ジョブスケジューラー
SELECT * FROM DBA_AUTOTASK_CLIENT;
SELECT * FROM DBA_SCHEDULER_WINDOWS;
```


